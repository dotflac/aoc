we were racing so this code is horrific but i will come back and write it properly
